<%= content_for :head do %>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <title><%= @article.seo_title %> — ContentForce</title>
  <meta name="description" content="<%= @article.seo_description %>">

  <!-- Open Graph -->
  <meta property="og:title" content="<%= @article.seo_title %>">
  <meta property="og:description" content="<%= @article.seo_description %>">
  <meta property="og:type" content="article">
  <meta property="og:url" content="<%= article_url(@article) %>">
  <% if @article.cover_image.attached? %>
    <meta property="og:image" content="<%= url_for(@article.cover_image) %>">
  <% end %>

  <!-- Article metadata -->
  <meta property="article:published_time" content="<%= @article.published_at&.iso8601 %>">
  <meta property="article:author" content="ContentForce">
  <% if @article.category.present? %>
    <meta property="article:section" content="<%= @article.category %>">
  <% end %>
<% end %>

<style>
  .article-page {
    --accent: #00D4AA;
    --bg-dark: #0A0A0B;
    --bg-card: #111113;
    --bg-elevated: #1A1A1D;
    --text-primary: #FAFAFA;
    --text-secondary: #A1A1AA;
    --text-muted: #71717A;
    --border: #27272A;
    font-family: 'Space Grotesk', system-ui, sans-serif;
  }

  .article-page code, .article-page .mono {
    font-family: 'JetBrains Mono', monospace;
  }

  .grain-overlay {
    position: fixed;
    top: -50%;
    left: -50%;
    right: -50%;
    bottom: -50%;
    width: 200%;
    height: 200vh;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
    opacity: 0.03;
    pointer-events: none;
    z-index: 100;
  }

  .article-content {
    line-height: 1.8;
  }

  .article-content h1 {
    font-size: 2rem;
    font-weight: 700;
    margin-top: 2.5rem;
    margin-bottom: 1rem;
    color: var(--text-primary);
  }

  .article-content h2 {
    font-size: 1.5rem;
    font-weight: 600;
    margin-top: 2rem;
    margin-bottom: 0.75rem;
    color: var(--text-primary);
  }

  .article-content h3 {
    font-size: 1.25rem;
    font-weight: 600;
    margin-top: 1.5rem;
    margin-bottom: 0.5rem;
    color: var(--text-primary);
  }

  .article-content p {
    margin-bottom: 1.25rem;
    color: var(--text-secondary);
  }

  .article-content ul, .article-content ol {
    margin-bottom: 1.25rem;
    padding-left: 1.5rem;
    color: var(--text-secondary);
  }

  .article-content li {
    margin-bottom: 0.5rem;
  }

  .article-content code {
    background: var(--bg-elevated);
    padding: 0.125rem 0.375rem;
    border-radius: 4px;
    font-size: 0.875rem;
  }

  .article-content pre {
    background: var(--bg-elevated);
    padding: 1rem;
    border-radius: 8px;
    overflow-x: auto;
    margin-bottom: 1.25rem;
  }

  .article-content pre code {
    background: none;
    padding: 0;
  }

  .article-content blockquote {
    border-left: 3px solid var(--accent);
    padding-left: 1rem;
    margin: 1.5rem 0;
    color: var(--text-muted);
    font-style: italic;
  }

  .article-content a {
    color: var(--accent);
    text-decoration: underline;
    text-underline-offset: 2px;
  }

  .article-content a:hover {
    opacity: 0.8;
  }

  .article-content img {
    max-width: 100%;
    height: auto;
    border-radius: 8px;
    margin: 1.5rem 0;
  }

  .article-content strong {
    color: var(--text-primary);
    font-weight: 600;
  }

  .related-card {
    transition: all 0.3s ease;
  }

  .related-card:hover {
    border-color: var(--accent);
    transform: translateY(-2px);
  }
</style>

<div class="article-page min-h-screen bg-[#0A0A0B] text-[#FAFAFA]">
  <div class="grain-overlay"></div>

  <!-- Navigation -->
  <nav class="sticky top-0 z-50 backdrop-blur-xl bg-[#0A0A0B]/80 border-b border-[#27272A]/50">
    <div class="max-w-4xl mx-auto px-6 lg:px-8">
      <div class="flex justify-between items-center h-16">
        <%= link_to root_path, class: "flex items-center gap-3 group" do %>
          <div class="w-9 h-9 bg-[#00D4AA] rounded-lg flex items-center justify-center font-bold text-[#0A0A0B] text-sm group-hover:rotate-[-8deg] transition-transform duration-300">
            CF
          </div>
          <span class="text-lg font-semibold tracking-tight">ContentForce</span>
        <% end %>

        <div class="flex items-center gap-4 text-sm">
          <%= link_to "Блог", blog_path, class: "text-[#A1A1AA] hover:text-[#00D4AA] transition-colors" %>
          <%= link_to "Документация", docs_path, class: "text-[#A1A1AA] hover:text-[#00D4AA] transition-colors" %>
        </div>
      </div>
    </div>
  </nav>

  <!-- Article -->
  <article class="max-w-4xl mx-auto px-6 lg:px-8 py-12">
    <!-- Breadcrumb -->
    <nav class="flex items-center gap-2 text-sm text-[#71717A] mb-8">
      <%= link_to "Блог", blog_path, class: "hover:text-[#00D4AA] transition-colors" %>
      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
      </svg>
      <% if @article.category.present? %>
        <%= link_to @article.category.titleize, blog_path(category: @article.category), class: "hover:text-[#00D4AA] transition-colors" %>
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
        </svg>
      <% end %>
      <span class="text-[#A1A1AA] truncate max-w-xs"><%= @article.title %></span>
    </nav>

    <!-- Header -->
    <header class="mb-10">
      <div class="flex items-center gap-3 mb-4">
        <% if @article.category.present? %>
          <span class="px-3 py-1 bg-[#00D4AA]/10 text-[#00D4AA] text-sm font-medium rounded-full">
            <%= @article.category.titleize %>
          </span>
        <% end %>
        <span class="text-sm text-[#71717A]">
          <%= @article.published_at&.strftime("%d %B %Y") || @article.created_at.strftime("%d %B %Y") %>
        </span>
        <% if @article.reading_time.present? %>
          <span class="text-sm text-[#71717A]">
            &bull; <%= @article.reading_time %> мин чтения
          </span>
        <% end %>
      </div>

      <h1 class="text-3xl lg:text-4xl font-bold tracking-tight mb-4">
        <%= @article.title %>
      </h1>

      <% if @article.excerpt.present? %>
        <p class="text-xl text-[#A1A1AA] leading-relaxed">
          <%= @article.excerpt %>
        </p>
      <% end %>
    </header>

    <!-- Cover Image -->
    <% if @article.cover_image.attached? %>
      <div class="mb-10 rounded-2xl overflow-hidden">
        <%= image_tag @article.cover_image, class: "w-full", alt: @article.title %>
      </div>
    <% end %>

    <!-- Content -->
    <div class="article-content">
      <%= simple_format(@article.content) %>
    </div>

    <!-- Tags -->
    <% if @article.tags.present? && @article.tags.any? %>
      <div class="mt-10 pt-6 border-t border-[#27272A]">
        <div class="flex flex-wrap gap-2">
          <% @article.tags.each do |tag| %>
            <span class="px-3 py-1 bg-[#1A1A1D] text-[#A1A1AA] text-sm rounded-full border border-[#27272A]">
              #<%= tag %>
            </span>
          <% end %>
        </div>
      </div>
    <% end %>

    <!-- Share -->
    <div class="mt-10 pt-6 border-t border-[#27272A]">
      <div class="flex items-center gap-4">
        <span class="text-sm text-[#71717A]">Поделиться:</span>
        <a href="https://t.me/share/url?url=<%= CGI.escape(article_url(@article)) %>&text=<%= CGI.escape(@article.title) %>" target="_blank" rel="noopener" class="w-10 h-10 bg-[#1A1A1D] border border-[#27272A] rounded-lg flex items-center justify-center hover:border-[#00D4AA] transition-colors">
          <svg class="w-5 h-5 text-[#A1A1AA]" fill="currentColor" viewBox="0 0 24 24">
            <path d="M12 0C5.373 0 0 5.373 0 12s5.373 12 12 12 12-5.373 12-12S18.627 0 12 0zm5.562 8.161c-.18.717-.962 3.767-1.362 5.001-.168.52-.504.694-.826.71-.702.033-1.235-.464-1.913-.908-1.061-.695-1.662-1.127-2.693-1.805-.119-.078-.238-.158-.356-.239a.734.734 0 01.05-1.171c.294-.24 2.661-2.426 2.661-2.426s.172-.177.161-.284a.316.316 0 00-.189-.238 1.02 1.02 0 00-.373-.05c-.177.011-2.986 1.897-8.428 5.571-.797.548-1.52.815-2.165.801-.713-.016-2.082-.403-3.104-.736-.125-.041-.247-.081-.364-.121a.722.722 0 01-.437-.873c.056-.148.146-.258.256-.354.851-.748 8.666-3.758 10.818-4.677 5.112-2.186 6.184-2.568 6.876-2.58.153-.002.495.035.716.214.186.149.238.351.263.494.024.143.056.466.032.72z"/>
          </svg>
        </a>
        <a href="https://twitter.com/intent/tweet?url=<%= CGI.escape(article_url(@article)) %>&text=<%= CGI.escape(@article.title) %>" target="_blank" rel="noopener" class="w-10 h-10 bg-[#1A1A1D] border border-[#27272A] rounded-lg flex items-center justify-center hover:border-[#00D4AA] transition-colors">
          <svg class="w-5 h-5 text-[#A1A1AA]" fill="currentColor" viewBox="0 0 24 24">
            <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
          </svg>
        </a>
      </div>
    </div>

    <!-- Author -->
    <div class="mt-10 p-6 bg-[#111113] border border-[#27272A] rounded-2xl">
      <div class="flex items-center gap-4">
        <div class="w-12 h-12 bg-[#00D4AA] rounded-full flex items-center justify-center font-bold text-[#0A0A0B]">
          CF
        </div>
        <div>
          <div class="font-semibold">ContentForce Team</div>
          <div class="text-sm text-[#A1A1AA]">Команда экспертов по контент-маркетингу и AI</div>
        </div>
      </div>
    </div>
  </article>

  <!-- Related Articles -->
  <% if @related_articles.any? %>
    <section class="max-w-4xl mx-auto px-6 lg:px-8 pb-16">
      <h2 class="text-xl font-bold mb-6">Похожие статьи</h2>
      <div class="grid md:grid-cols-3 gap-6">
        <% @related_articles.each do |article| %>
          <%= link_to article_path(article), class: "related-card block bg-[#111113] border border-[#27272A] rounded-xl overflow-hidden" do %>
            <div class="aspect-video bg-[#1A1A1D]">
              <% if article.cover_image.attached? %>
                <%= image_tag article.cover_image, class: "w-full h-full object-cover", alt: article.title %>
              <% end %>
            </div>
            <div class="p-4">
              <h3 class="font-medium mb-2 line-clamp-2"><%= article.title %></h3>
              <span class="text-xs text-[#71717A]">
                <%= article.published_at&.strftime("%d.%m.%Y") %>
              </span>
            </div>
          <% end %>
        <% end %>
      </div>
    </section>
  <% end %>

  <!-- CTA -->
  <section class="max-w-4xl mx-auto px-6 lg:px-8 pb-16">
    <div class="bg-gradient-to-r from-[#00D4AA]/10 to-[#00D4AA]/5 border border-[#00D4AA]/20 rounded-2xl p-8 text-center">
      <h2 class="text-2xl font-bold mb-3">Готовы автоматизировать контент?</h2>
      <p class="text-[#A1A1AA] mb-6 max-w-lg mx-auto">
        Попробуйте ContentForce бесплатно и создавайте посты для Telegram с помощью AI.
      </p>
      <%= link_to "Начать бесплатно", new_user_registration_path, class: "px-6 py-3 bg-[#00D4AA] text-[#0A0A0B] font-semibold rounded-lg hover:bg-[#00D4AA]/90 transition-colors inline-block" %>
    </div>
  </section>

  <!-- Footer -->
  <footer class="max-w-4xl mx-auto px-6 lg:px-8 py-8 border-t border-[#27272A]">
    <div class="flex flex-col md:flex-row justify-between items-center gap-4">
      <div class="flex items-center gap-6 text-sm">
        <%= link_to "О нас", about_path, class: "text-[#71717A] hover:text-[#00D4AA] transition-colors" %>
        <%= link_to "Документация", docs_path, class: "text-[#71717A] hover:text-[#00D4AA] transition-colors" %>
        <%= link_to "Блог", blog_path, class: "text-[#71717A] hover:text-[#00D4AA] transition-colors" %>
        <%= link_to "Контакты", contacts_path, class: "text-[#71717A] hover:text-[#00D4AA] transition-colors" %>
      </div>
      <div class="flex items-center gap-6 text-sm">
        <%= link_to "Политика", privacy_path, class: "text-[#71717A] hover:text-[#00D4AA] transition-colors" %>
        <%= link_to "Оферта", terms_path, class: "text-[#71717A] hover:text-[#00D4AA] transition-colors" %>
      </div>
    </div>
  </footer>
</div>
