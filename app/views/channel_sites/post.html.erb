<article class="max-w-4xl mx-auto px-6 py-8" itemscope itemtype="https://schema.org/Article">
  <!-- Breadcrumbs -->
  <nav class="mb-6 text-sm text-zinc-500 flex items-center gap-2">
    <a href="/" class="hover:text-white transition-colors flex items-center gap-1">
      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/>
      </svg>
    </a>
    <svg class="w-4 h-4 text-zinc-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
      <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"/>
    </svg>
    <a href="/posts" class="hover:text-white transition-colors">Публикации</a>
    <svg class="w-4 h-4 text-zinc-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
      <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"/>
    </svg>
    <span class="text-zinc-400 truncate max-w-[200px]"><%= @channel_post.display_title&.truncate(30) %></span>
  </nav>

  <!-- Header -->
  <header class="mb-6">
    <h1 class="text-2xl md:text-3xl font-bold mb-3" itemprop="headline">
      <%= @channel_post.display_title %>
    </h1>

    <div class="flex flex-wrap items-center gap-3 text-zinc-500 text-sm">
      <time datetime="<%= @channel_post.telegram_date.iso8601 %>" itemprop="datePublished" class="flex items-center gap-1">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
        </svg>
        <%= l(@channel_post.telegram_date, format: :long) rescue @channel_post.telegram_date.strftime('%d.%m.%Y') %>
      </time>
      <span class="w-1 h-1 rounded-full bg-zinc-600"></span>
      <span class="flex items-center gap-1">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
          <path stroke-linecap="round" stroke-linejoin="round" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
        </svg>
        <%= @channel_post.views_count + @channel_post.site_views_count %> просмотров
      </span>
    </div>
  </header>

  <!-- Media -->
  <% if @channel_post.first_image.present? %>
    <figure class="mb-6">
      <img src="<%= @channel_post.first_image %>"
           alt="<%= @channel_post.display_title %>"
           class="w-full rounded-lg"
           itemprop="image">
    </figure>
  <% end %>

  <!-- Content -->
  <div class="prose prose-invert prose-base max-w-none mb-8" itemprop="articleBody">
    <%= simple_format(@channel_post.display_content) %>
  </div>

  <!-- Telegram Link -->
  <% if @channel_post.telegram_url.present? %>
    <div class="card p-4 mb-8">
      <div class="flex items-center justify-between gap-4">
        <div class="flex items-center gap-3">
          <div class="w-10 h-10 rounded-full bg-zinc-800 flex items-center justify-center">
            <svg class="w-5 h-5 accent" fill="currentColor" viewBox="0 0 24 24">
              <path d="M12 0C5.373 0 0 5.373 0 12s5.373 12 12 12 12-5.373 12-12S18.627 0 12 0zm5.894 8.221l-1.97 9.28c-.145.658-.537.818-1.084.508l-3-2.21-1.446 1.394c-.14.18-.357.223-.548.223l.188-2.85 5.18-4.686c.223-.198-.054-.308-.346-.11l-6.4 4.02-2.76-.918c-.6-.187-.612-.6.125-.89l10.782-4.156c.5-.18.94.12.78.89z"/>
            </svg>
          </div>
          <div>
            <p class="text-sm font-medium text-white">Читать в Telegram</p>
            <p class="text-xs text-zinc-500">Оригинальный пост</p>
          </div>
        </div>
        <a href="<%= @channel_post.telegram_url %>"
           target="_blank"
           rel="noopener noreferrer"
           class="inline-flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-zinc-800 hover:bg-zinc-700 transition-colors text-sm">
          Открыть
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"/>
          </svg>
        </a>
      </div>
    </div>
  <% end %>

  <!-- Navigation -->
  <nav class="flex items-center justify-between gap-4 pt-6 border-t border-zinc-800">
    <% if @prev_post %>
      <a href="/post/<%= @prev_post.to_param %>" class="group flex-1 card p-3 hover:bg-zinc-800/50 transition-colors">
        <div class="flex items-center gap-2">
          <svg class="w-4 h-4 text-zinc-500 group-hover:accent transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7"/>
          </svg>
          <div class="min-w-0">
            <span class="block text-xs text-zinc-500">Предыдущий</span>
            <span class="block text-sm text-zinc-300 group-hover:text-white transition-colors truncate"><%= @prev_post.display_title&.truncate(35) %></span>
          </div>
        </div>
      </a>
    <% else %>
      <div class="flex-1"></div>
    <% end %>

    <% if @next_post %>
      <a href="/post/<%= @next_post.to_param %>" class="group flex-1 card p-3 hover:bg-zinc-800/50 transition-colors text-right">
        <div class="flex items-center justify-end gap-2">
          <div class="min-w-0">
            <span class="block text-xs text-zinc-500">Следующий</span>
            <span class="block text-sm text-zinc-300 group-hover:text-white transition-colors truncate"><%= @next_post.display_title&.truncate(35) %></span>
          </div>
          <svg class="w-4 h-4 text-zinc-500 group-hover:accent transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"/>
          </svg>
        </div>
      </a>
    <% end %>
  </nav>
</article>

<!-- Schema.org JSON-LD -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Article",
  "headline": "<%= j(@channel_post.display_title) %>",
  "datePublished": "<%= @channel_post.telegram_date.iso8601 %>",
  "dateModified": "<%= @channel_post.updated_at.iso8601 %>",
  "author": {
    "@type": "Organization",
    "name": "<%= j(@channel_site.site_title || @channel_site.telegram_bot.channel_name) %>"
  },
  "publisher": {
    "@type": "Organization",
    "name": "ContentForce"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "<%= @channel_site.full_url %>/post/<%= @channel_post.to_param %>"
  }
}
</script>
