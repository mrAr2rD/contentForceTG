<div class="dashboard-page">
  <!-- Header -->
  <% header_actions = capture do %>
    <%= link_to new_project_path, class: "inline-flex items-center gap-2 px-4 py-2 bg-zinc-900 text-zinc-50 hover:bg-zinc-900/90 dark:bg-zinc-50 dark:text-zinc-900 dark:hover:bg-zinc-50/90 rounded-md text-sm font-medium transition-colors shadow-sm" do %>
      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4"/>
      </svg>
      Новый проект
    <% end %>
  <% end %>
  <%= render 'shared/page_header',
      title: "Проекты",
      subtitle: "Управляйте вашими контент-проектами",
      actions: header_actions %>

  <% if @projects.any? %>
    <!-- Projects Grid - Notion style cards -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
      <% @projects.each do |project| %>
        <%= link_to project_path(project), class: "group rounded-lg border border-zinc-200 dark:border-zinc-800 bg-white dark:bg-zinc-950 p-6 hover:shadow-md transition-all" do %>
          <!-- Project Icon & Status -->
          <div class="flex items-start justify-between mb-4">
            <div class="w-12 h-12 bg-gradient-to-br from-zinc-100 to-zinc-200 dark:from-zinc-800 dark:to-zinc-700 rounded-lg flex items-center justify-center text-zinc-700 dark:text-zinc-300 text-lg font-bold shadow-sm">
              <%= project.name[0].upcase %>
            </div>
            <% if project.archived_at.nil? %>
              <span class="inline-flex items-center px-2 py-1 bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-400 text-xs font-medium rounded-md">
                <span class="w-1.5 h-1.5 bg-green-500 rounded-full mr-1.5"></span>
                Активный
              </span>
            <% else %>
              <span class="inline-flex items-center px-2 py-1 bg-zinc-100 dark:bg-zinc-800 text-zinc-600 dark:text-zinc-400 text-xs font-medium rounded-md">
                Архив
              </span>
            <% end %>
          </div>

          <!-- Project Name -->
          <h3 class="text-base font-semibold text-zinc-900 dark:text-zinc-50 mb-2 group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-colors">
            <%= project.name %>
          </h3>
          
          <!-- Project Description -->
          <p class="text-sm text-zinc-600 dark:text-zinc-400 mb-4 line-clamp-2 leading-relaxed">
            <%= project.description.presence || "Без описания" %>
          </p>

          <!-- Project Meta -->
          <div class="flex items-center gap-4 text-xs text-zinc-500 dark:text-zinc-400 pt-4 border-t border-zinc-200 dark:border-zinc-800">
            <span class="flex items-center gap-1.5">
              <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
              </svg>
              <%= project.posts.count %> постов
            </span>
            <span class="flex items-center gap-1.5">
              <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"/>
              </svg>
              <%= project.telegram_bots.count %> ботов
            </span>
          </div>

          <!-- Updated Time -->
          <div class="mt-3 text-xs text-zinc-400 dark:text-zinc-600">
            Обновлен <%= time_ago_in_words(project.updated_at) %> назад
          </div>
        <% end %>
      <% end %>
    </div>
  <% else %>
    <!-- Empty State - Notion style -->
    <div class="rounded-lg border border-zinc-200 dark:border-zinc-800 bg-white dark:bg-zinc-950 p-16 text-center">
      <div class="w-16 h-16 bg-zinc-100 dark:bg-zinc-800 rounded-full flex items-center justify-center mx-auto mb-6">
        <svg class="w-8 h-8 text-zinc-400 dark:text-zinc-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/>
        </svg>
      </div>
      <h3 class="text-lg font-semibold text-zinc-900 dark:text-zinc-50 mb-2">
        Нет проектов
      </h3>
      <p class="text-sm text-zinc-600 dark:text-zinc-400 mb-8 max-w-md mx-auto">
        Создайте первый проект, чтобы начать работу с ContentForce. Проекты помогают организовать ваш контент и настроить AI под ваши нужды.
      </p>
      <%= link_to new_project_path, class: "inline-flex items-center gap-2 px-6 py-3 bg-zinc-900 text-zinc-50 hover:bg-zinc-900/90 dark:bg-zinc-50 dark:text-zinc-900 dark:hover:bg-zinc-50/90 rounded-md text-sm font-medium transition-colors shadow-sm" do %>
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4"/>
        </svg>
        Создать первый проект
      <% end %>
    </div>
  <% end %>
</div>
